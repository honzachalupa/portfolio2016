function getData(){var e=new XMLHttpRequest;e.onreadystatechange=function(){4==this.readyState&&200==this.status&&(window.data=JSON.parse(this.responseText),getData_Locally())},e.open("GET","http://www.honzachalupa.cz/dev/data/data.json",!0),e.send()}function getData_Locally(){var e=window.data,t=0;if(e.length>0){var i=shuffleArray(e),a=structureItems(i);renderItems(a),adjustTiles()}else t<10?(t++,setTimeout(function(){getData_Locally()},200)):alert("Something really bad happened. I'm sorry. :(")}function structureItems(e){var t=[];for(var i in e){var a=e[i];if("project"==a.Type)t.push({type:"item",tile:{type:a.Type,title:a.Title,image:a.ImageUrl1},link:"pages/detail.html?type="+a.Type+"&id="+a.Id});else if("image"==a.Type)t.push({type:"item",tile:{type:a.Type,url:a.Url},link:"pages/detail.html?type="+a.Type+"&id="+a.Id});else{if("tweet"!=a.Type)throw new Error("Unknown tile type: "+a.Type);t.push({type:"item",tile:{type:a.Type,text:a.Text},link:a.Url})}}return t}function renderItems(e){var t="";for(var i in e){var a=e[i];if("items-group"==a.type){t+="<div class='items-group'>";for(var r in a.items){var n=a.items[r];t+=renderItemContent(n,2)}t+="</div>"}else{var n=a;t+=renderItemContent(n,1)}}document.querySelector(".render-target").innerHTML=t}function renderItemContent(e,t){var i=e.tile,a=e.tile.type,r="<a class='item level-"+t+" "+a+"' href='"+e.link+"'>";return"project"==a?r+="<div class='image-container' style='background-image: url("+i.image+")'></div><p class='title'>"+i.title+"</p>":"image"==a?r+="<div class='image-container' style='background-image: url("+i.url+")'></div>":"tweet"==a&&(r+="<p class='text'>"+e.text+"</p><div class='icon'></div>"),r+="</a>"}function adjustTiles(){var e=4,t=$(window).height()/e,i=Math.floor(($(window).width()-$(".side").width())/t);$("div.items-group, a.item.level-1").css("flex-basis","calc(100% / "+i+")"),$(".item, .items-group").each(function(){$(this).height($(this).width())})}function shuffleArray(e){for(var t,i,a=e.length;0!==a;)i=Math.floor(Math.random()*a),a-=1,t=e[a],e[a]=e[i],e[i]=t;return e}window.onresize=function(){adjustTiles()};