"use strict";function getData(){var e=new XMLHttpRequest;e.onreadystatechange=function(){4==this.readyState&&200==this.status&&(window.data=JSON.parse(this.responseText),getData_Locally())},e.open("GET","http://www.honzachalupa.cz/dev/data/data.json",!0),e.send()}function getData_Locally(){var e=window,t=e.data,i=0;if(t.length>0){var a=shuffleArray(t),r=structureItems(a);renderItems(r),adjustTiles()}else i<10?(i++,setTimeout(function(){getData_Locally()},200)):alert("Something really bad happened. I'm sorry. :(")}function structureItems(e){var t=[];for(var i in e){var a=e[i],r=a.Type;if("project"==r)t.push({type:"item",tile:{type:a.Type,title:a.Title,image:a.ImageUrl1},link:"detail.html?type="+a.Type+"&id="+a.Id});else if("image"==r)t.push({type:"item",tile:{type:a.Type,url:a.Url},link:"detail.html?type="+a.Type+"&id="+a.Id});else{if("tweet"!=r)throw new Error("Unknown tile type: "+a.Type);t.push({type:"item",tile:{type:a.Type,text:a.Text},link:a.Url})}}return t}function renderItems(e){var t="";for(var i in e){var a=e[i];if("items-group"==a.type){t+="<div class='items-group'>";for(var r in a.items){var n=a.items[r];t+=renderItemContent(n,2)}t+="</div>"}else{var l=a;t+=renderItemContent(l,1)}}document.querySelector(".render-target").innerHTML=t}function renderItemContent(e,t){var i=e.tile,a=e.tile.type,r='<a class="item level-'+t+" "+a+'" href="'+e.link+'" label="'+getTileLabel(a)+'">';return"project"==a?r+='<div class="image-container" style="background-image: url(\''+i.image+"')\"></div>\n            <p class='title'>"+i.title+"</p>":"image"==a?r+='<div class="image-container" style="background-image: url(\''+i.url+"')\"></div>":"tweet"==a&&(r+='<p class="text">'+i.text+"</p>\n            <div class='icon'></div>"),r+="</a>"}function getTileLabel(e){switch(e){case"project":return"Show detail";case"image":return"Show in gallery";case"tweet":return"Visit my Twitter page";default:return""}}function adjustTiles(){console.log("y");var e=3,t=$(window).height()/e,i=Math.floor(($(window).width()-$(".side").width())/t);$("div.items-group, a.item.level-1").css("flex-basis","calc(100% / "+i+")"),$(".item, .items-group").each(function(){$(this).height($(this).width())})}function shuffleArray(e){for(var t=e.length,i=void 0,a=void 0;0!==t;)a=Math.floor(Math.random()*t),t-=1,i=e[t],e[t]=e[a],e[a]=i;return e}$("document").ready(function(){adjustTiles()}),$(window).resize(function(){adjustTiles()});